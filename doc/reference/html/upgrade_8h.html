<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>BlueLab: upgrade.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BlueLab
   &#160;<span id="projectnumber">BlueLab-7.1-Release</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_885cc87fac2d91e269af0a5a959fa5f6.html">E:</a></li><li class="navelem"><a class="el" href="dir_c7e0e8d12b42f3739b71747656f18cd0.html">work_layne</a></li><li class="navelem"><a class="el" href="dir_21e8aa1b508721822d5da9358e8a66b3.html">layne</a></li><li class="navelem"><a class="el" href="dir_e4efa088505d514b69950f8abe76ce9a.html">csr8670</a></li><li class="navelem"><a class="el" href="dir_d69a05324820a15d5f908ec5057bc420.html">tools</a></li><li class="navelem"><a class="el" href="dir_33b4f9d0a7e332b5324a4fedfd59dca5.html">include</a></li><li class="navelem"><a class="el" href="dir_44c03d276c84dc60e1983191218d045d.html">profiles</a></li><li class="navelem"><a class="el" href="dir_b3f9a24247bf22b136dbe9f636bcbdbd.html">BlueLab-7.1-Release</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">upgrade.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Header file for the Upgrade library.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structupgrade__version.html">upgrade_version</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A {major, minor} pair defines an upgrade version.  <a href="structupgrade__version.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_u_p_g_r_a_d_e___t_r_a_n_s_p_o_r_t___c_o_n_n_e_c_t___c_f_m___t.html">UPGRADE_TRANSPORT_CONNECT_CFM_T</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Definition of the message sent in response to <a class="el" href="upgrade_8h.html#a28b2bf314b91c0f5c363229c71462e73" title="Connect a transport to the Upgrade library. ">UpgradeTransportConnectRequest()</a>.  <a href="struct_u_p_g_r_a_d_e___t_r_a_n_s_p_o_r_t___c_o_n_n_e_c_t___c_f_m___t.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_u_p_g_r_a_d_e___t_r_a_n_s_p_o_r_t___d_a_t_a___c_f_m___t.html">UPGRADE_TRANSPORT_DATA_CFM_T</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Definition of the message sent in response to <a class="el" href="upgrade_8h.html#a7e6e5dcd93dcb19474939f5fb7b32517" title="Pass a data packet from a client to the Upgrade library. ">UpgradeProcessDataRequest()</a>.  <a href="struct_u_p_g_r_a_d_e___t_r_a_n_s_p_o_r_t___d_a_t_a___c_f_m___t.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_u_p_g_r_a_d_e___t_r_a_n_s_p_o_r_t___d_a_t_a___i_n_d___t.html">UPGRADE_TRANSPORT_DATA_IND_T</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Definition of the message sent to a transport to send a data packet to a client.  <a href="struct_u_p_g_r_a_d_e___t_r_a_n_s_p_o_r_t___d_a_t_a___i_n_d___t.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_u_p_g_r_a_d_e___t_r_a_n_s_p_o_r_t___d_i_s_c_o_n_n_e_c_t___c_f_m___t.html">UPGRADE_TRANSPORT_DISCONNECT_CFM_T</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Definition of the message sent in response to <a class="el" href="upgrade_8h.html#a91f2bcad38ebf0c7a1b4744a6f933ed2" title="Disconnect a transport from the Upgrade library. ">UpgradeTransportDisconnectRequest()</a>.  <a href="struct_u_p_g_r_a_d_e___t_r_a_n_s_p_o_r_t___d_i_s_c_o_n_n_e_c_t___c_f_m___t.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_u_p_g_r_a_d_e___i_n_i_t___c_f_m___t.html">UPGRADE_INIT_CFM_T</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Definition of the message sent in response to <a class="el" href="upgrade_8h.html#aeeb2e43c8a780702137808dad885260e" title="Initialise the Upgrade library. ">UpgradeInit()</a>.  <a href="struct_u_p_g_r_a_d_e___i_n_i_t___c_f_m___t.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_u_p_g_r_a_d_e___r_e_s_t_a_r_t_e_d___i_n_d___t.html">UPGRADE_RESTARTED_IND_T</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Definition of message that may be sent as a result of <a class="el" href="upgrade_8h.html#aeeb2e43c8a780702137808dad885260e" title="Initialise the Upgrade library. ">UpgradeInit()</a> being called.  <a href="struct_u_p_g_r_a_d_e___r_e_s_t_a_r_t_e_d___i_n_d___t.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_u_p_g_r_a_d_e___s_t_a_t_u_s___i_n_d___t.html">UPGRADE_STATUS_IND_T</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Message indicating change in state of the upgrade library.  <a href="struct_u_p_g_r_a_d_e___s_t_a_t_u_s___i_n_d___t.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_u_p_g_r_a_d_e___u_p_g_r_a_d_a_b_l_e___p_a_r_t_i_t_i_o_n___t.html">UPGRADE_UPGRADABLE_PARTITION_T</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Element defining the physical partitions in flash that apply to this logical partition.  <a href="struct_u_p_g_r_a_d_e___u_p_g_r_a_d_a_b_l_e___p_a_r_t_i_t_i_o_n___t.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a8c1d3fc95a1be73bdae951db217b0178"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="upgrade_8h.html#a8c1d3fc95a1be73bdae951db217b0178">UPGRADE_HOST_IF_MSG_BASE</a>&#160;&#160;&#160;0x500</td></tr>
<tr class="separator:a8c1d3fc95a1be73bdae951db217b0178"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d196d818f11fad478fb4684e69fd0aa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="upgrade_8h.html#a2d196d818f11fad478fb4684e69fd0aa">UPGRADE_INIT_POWER_MANAGEMENT</a>&#160;&#160;&#160;<a class="el" href="upgrade_8h.html#abefdb7759810ea490f6e1f78c7989e5baac57a380b709ce065434ffafe25b965f">upgrade_power_management_disabled</a></td></tr>
<tr class="separator:a2d196d818f11fad478fb4684e69fd0aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae75379efe615d6123c85607c36aa6897"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="upgrade_8h.html#ae75379efe615d6123c85607c36aa6897">UPGRADE_DEFAULT_DEV_VARIANT</a>&#160;&#160;&#160;&quot;ZARKOV77&quot;</td></tr>
<tr class="separator:ae75379efe615d6123c85607c36aa6897"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8786c0c6d582457ac5beef66fa71ba3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="upgrade_8h.html#ad8786c0c6d582457ac5beef66fa71ba3">UPGRADE_PARTITION_SINGLE</a>(bank, banktype)&#160;&#160;&#160;{ bank, 0, bank, UPGRADE_LOGICAL_BANKING_SINGLE_##banktype }</td></tr>
<tr class="memdesc:ad8786c0c6d582457ac5beef66fa71ba3"><td class="mdescLeft">&#160;</td><td class="mdescRight">macro to be used when initialising an <a class="el" href="struct_u_p_g_r_a_d_e___u_p_g_r_a_d_a_b_l_e___p_a_r_t_i_t_i_o_n___t.html" title="Element defining the physical partitions in flash that apply to this logical partition. ">UPGRADE_UPGRADABLE_PARTITION_T</a> entry.  <a href="#ad8786c0c6d582457ac5beef66fa71ba3">More...</a><br/></td></tr>
<tr class="separator:ad8786c0c6d582457ac5beef66fa71ba3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1aba23a64dc86dc6d24176c413d1232f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="upgrade_8h.html#a1aba23a64dc86dc6d24176c413d1232f">UPGRADE_PARTITION_DOUBLE</a>(first_bank, second_bank, banktype)&#160;&#160;&#160;{ first_bank, 0, second_bank, UPGRADE_LOGICAL_BANKING_DOUBLE_##banktype }</td></tr>
<tr class="memdesc:a1aba23a64dc86dc6d24176c413d1232f"><td class="mdescLeft">&#160;</td><td class="mdescRight">macro to be used when initialising an <a class="el" href="struct_u_p_g_r_a_d_e___u_p_g_r_a_d_a_b_l_e___p_a_r_t_i_t_i_o_n___t.html" title="Element defining the physical partitions in flash that apply to this logical partition. ">UPGRADE_UPGRADABLE_PARTITION_T</a> entry.  <a href="#a1aba23a64dc86dc6d24176c413d1232f">More...</a><br/></td></tr>
<tr class="separator:a1aba23a64dc86dc6d24176c413d1232f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:afb3e52d5bdfde3eb77f620f5b52c2e4a"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="upgrade_8h.html#afb3e52d5bdfde3eb77f620f5b52c2e4a">upgrade_status_t</a> { <br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#afb3e52d5bdfde3eb77f620f5b52c2e4aa88c518a488af1521263fcb7dfecc3afc">upgrade_status_success</a> = 0, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#afb3e52d5bdfde3eb77f620f5b52c2e4aa328e99b64fd88537897f0cb1f1d24b71">upgrade_status_unexpected_error</a>, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#afb3e52d5bdfde3eb77f620f5b52c2e4aa60bb194947b5e0301a0b289a893959d1">upgrade_status_already_connected_warning</a>, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#afb3e52d5bdfde3eb77f620f5b52c2e4aac8f4f891942eff5b04b75ce305869e74">upgrade_status_in_progress</a>, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#afb3e52d5bdfde3eb77f620f5b52c2e4aa841248efbd106f191459fd2856ce0997">upgrade_status_busy</a>, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#afb3e52d5bdfde3eb77f620f5b52c2e4aa99d684f574261ea10d2a8073560d03ec">upgrade_status_invalid_power_state</a>
<br/>
 }</td></tr>
<tr class="memdesc:afb3e52d5bdfde3eb77f620f5b52c2e4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumeration of status types used by Upgrade library API.  <a href="upgrade_8h.html#afb3e52d5bdfde3eb77f620f5b52c2e4a">More...</a><br/></td></tr>
<tr class="separator:afb3e52d5bdfde3eb77f620f5b52c2e4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abca8081d155a70bbaec4f4eb8aa43ff8"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="upgrade_8h.html#abca8081d155a70bbaec4f4eb8aa43ff8">upgrade_application_message</a> { <br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#abca8081d155a70bbaec4f4eb8aa43ff8aa0bfad1e4c764c2e9cd81658350f2d05">UPGRADE_INIT_CFM</a> = UPGRADE_UPSTREAM_MESSAGE_BASE, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#abca8081d155a70bbaec4f4eb8aa43ff8a126e0820b77ee3a8b1b6fc52ab76faec">UPGRADE_RESTARTED_IND</a>, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#abca8081d155a70bbaec4f4eb8aa43ff8ab1b469ac6df68b4faf8773a59edfcd6b">UPGRADE_APPLY_IND</a>, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#abca8081d155a70bbaec4f4eb8aa43ff8a2dc467a743fbdecc9ced48241f481fb4">UPGRADE_BLOCKING_IND</a>, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#abca8081d155a70bbaec4f4eb8aa43ff8ae6ebacda93ea7d7c3408d20517f67332">UPGRADE_BLOCKING_IS_DONE_IND</a>, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#abca8081d155a70bbaec4f4eb8aa43ff8a63845b901d54abe03cf35c58bb1e4c18">UPGRADE_STATUS_IND</a>, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#abca8081d155a70bbaec4f4eb8aa43ff8a791d75abb7b2ead5a5aa5337c241b76d">UPGRADE_UPSTREAM_MESSAGE_TOP</a>
<br/>
 }</td></tr>
<tr class="memdesc:abca8081d155a70bbaec4f4eb8aa43ff8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumeration of message IDs used by Upgrade library when sending messages to the application.  <a href="upgrade_8h.html#abca8081d155a70bbaec4f4eb8aa43ff8">More...</a><br/></td></tr>
<tr class="separator:abca8081d155a70bbaec4f4eb8aa43ff8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a221dfdae3f8abae8645ae636e94044"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="upgrade_8h.html#a0a221dfdae3f8abae8645ae636e94044">upgrade_transport_message</a> { <br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#a0a221dfdae3f8abae8645ae636e94044a3bb91e6cfeca8dcce82cb2a78dd83d12">UPGRADE_TRANSPORT_CONNECT_CFM</a> = UPGRADE_DOWNSTREAM_MESSAGE_BASE, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#a0a221dfdae3f8abae8645ae636e94044ac72f01268204b9246d4f0b39f662467d">UPGRADE_TRANSPORT_DISCONNECT_CFM</a>, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#a0a221dfdae3f8abae8645ae636e94044a381862e04eb48776b0b8a9fb48032370">UPGRADE_TRANSPORT_DATA_IND</a>, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#a0a221dfdae3f8abae8645ae636e94044a7109e55b3f87fb65252db77672180fa1">UPGRADE_TRANSPORT_DATA_CFM</a>, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#a0a221dfdae3f8abae8645ae636e94044a5c2b280183bd6aff7b2e15d50000fc47">UPGRADE_DOWNSTREAM_MESSAGE_TOP</a>
<br/>
 }</td></tr>
<tr class="memdesc:a0a221dfdae3f8abae8645ae636e94044"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumeration of message IDs used by the Upgrade library when sending messages to the transport task.  <a href="upgrade_8h.html#a0a221dfdae3f8abae8645ae636e94044">More...</a><br/></td></tr>
<tr class="separator:a0a221dfdae3f8abae8645ae636e94044"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaac5b24e409e269fdb8e330611d5d99e"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="upgrade_8h.html#aaac5b24e409e269fdb8e330611d5d99e">upgrade_permission_t</a> { <br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#aaac5b24e409e269fdb8e330611d5d99ea2057a0e19be6b50e1b446d8bba1b8f45">upgrade_perm_no</a>, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#aaac5b24e409e269fdb8e330611d5d99ea7d44485cbad805ea73f1b820ba692086">upgrade_perm_assume_yes</a>, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#aaac5b24e409e269fdb8e330611d5d99eae1f05ab99767ab7cff6e98fc9a0a4859">upgrade_perm_always_ask</a>
<br/>
 }</td></tr>
<tr class="memdesc:aaac5b24e409e269fdb8e330611d5d99e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Types of permission that are given to the upgrade library.  <a href="upgrade_8h.html#aaac5b24e409e269fdb8e330611d5d99e">More...</a><br/></td></tr>
<tr class="separator:aaac5b24e409e269fdb8e330611d5d99e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ca74f71fd564593dd716ae4b7b567f5"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="upgrade_8h.html#a3ca74f71fd564593dd716ae4b7b567f5">upgrade_state_t</a> { <br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#a3ca74f71fd564593dd716ae4b7b567f5abac05453a6990c61bc91273698975aac">upgrade_state_idle</a>, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#a3ca74f71fd564593dd716ae4b7b567f5af41033515c0ffa60979cf7d116082b55">upgrade_state_downloading</a>, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#a3ca74f71fd564593dd716ae4b7b567f5a5a6ad4645cf151b83cc0f4251d3ee5f3">upgrade_state_commiting</a>, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#a3ca74f71fd564593dd716ae4b7b567f5a734bc9be75d7b4d5cd15c7b2f2d83219">upgrade_state_done</a>
<br/>
 }</td></tr>
<tr class="memdesc:a3ca74f71fd564593dd716ae4b7b567f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">States which the upgrade library may be in.  <a href="upgrade_8h.html#a3ca74f71fd564593dd716ae4b7b567f5">More...</a><br/></td></tr>
<tr class="separator:a3ca74f71fd564593dd716ae4b7b567f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abefdb7759810ea490f6e1f78c7989e5b"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="upgrade_8h.html#abefdb7759810ea490f6e1f78c7989e5b">upgrade_power_management_t</a> { <br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#abefdb7759810ea490f6e1f78c7989e5baac57a380b709ce065434ffafe25b965f">upgrade_power_management_disabled</a>, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#abefdb7759810ea490f6e1f78c7989e5baf0725de6183ef7ac4399b27acd8cc7c3">upgrade_battery_powered</a>
<br/>
 }</td></tr>
<tr class="memdesc:abefdb7759810ea490f6e1f78c7989e5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumeration power management initialization.  <a href="upgrade_8h.html#abefdb7759810ea490f6e1f78c7989e5b">More...</a><br/></td></tr>
<tr class="separator:abefdb7759810ea490f6e1f78c7989e5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7acfcc0e02d33de311a7dfe9829cfad"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="upgrade_8h.html#af7acfcc0e02d33de311a7dfe9829cfad">upgrade_power_state_t</a> { <br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#af7acfcc0e02d33de311a7dfe9829cfada525af91cdf6390a26ddff8f88f6ee7b8">upgrade_battery_ok</a>, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#af7acfcc0e02d33de311a7dfe9829cfada2fea563568b2ac8117be83df152f1eed">upgrade_battery_low</a>, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#af7acfcc0e02d33de311a7dfe9829cfada42950af9f5a0fb4233f17ee02827d2fb">upgrade_charger_connected</a>
<br/>
 }</td></tr>
<tr class="memdesc:af7acfcc0e02d33de311a7dfe9829cfad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumeration power management state.  <a href="upgrade_8h.html#af7acfcc0e02d33de311a7dfe9829cfad">More...</a><br/></td></tr>
<tr class="separator:af7acfcc0e02d33de311a7dfe9829cfad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08466801879b35c7ddae4bddb3e3e9e0"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="upgrade_8h.html#a08466801879b35c7ddae4bddb3e3e9e0">upgrade_reconnect_recommendation_t</a> { <br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#a08466801879b35c7ddae4bddb3e3e9e0adc1095218f0111408b301812baa7039f">upgrade_reconnect_not_required</a>, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#a08466801879b35c7ddae4bddb3e3e9e0a908cd91bf55d2821919ed82f116b40bf">upgrade_reconnect_required_for_confirm</a>, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#a08466801879b35c7ddae4bddb3e3e9e0a6ae9da9ac32254101ade6af43f8415ff">upgrade_reconnect_recommended_as_completed</a>, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#a08466801879b35c7ddae4bddb3e3e9e0a1443ebff8e33b953c796cfce3d51486b">upgrade_reconnect_recommended_in_progress</a>
<br/>
 }</td></tr>
<tr class="memdesc:a08466801879b35c7ddae4bddb3e3e9e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reasons for reconnection.  <a href="upgrade_8h.html#a08466801879b35c7ddae4bddb3e3e9e0">More...</a><br/></td></tr>
<tr class="separator:a08466801879b35c7ddae4bddb3e3e9e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b1354373fa3ef827b9d6968b17b1443"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="upgrade_8h.html#a4b1354373fa3ef827b9d6968b17b1443">UPGRADE_LOGICAL_PARTITION_ARRANGEMENT</a> { <br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#a4b1354373fa3ef827b9d6968b17b1443abb8cf6d57e3ce55b6fa529d95be7c673">UPGRADE_LOGICAL_BANKING_SINGLE_KEEP_ERASED</a>, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#a4b1354373fa3ef827b9d6968b17b1443a7e6abf6fef2b5d84efc0f8c18daf6ef1">UPGRADE_LOGICAL_BANKING_SINGLE_DFU</a> = UPGRADE_LOGICAL_BANKING_SINGLE_KEEP_ERASED, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#a4b1354373fa3ef827b9d6968b17b1443a2ff3bb74dd654f5861c98b0380ba6ecc">UPGRADE_LOGICAL_BANKING_DOUBLE_UNMOUNTED</a>, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#a4b1354373fa3ef827b9d6968b17b1443a3148d7cac57e30af1fd9598cf3a7c2d1">UPGRADE_LOGICAL_BANKING_DOUBLE_MOUNTED</a>, 
<br/>
&#160;&#160;<a class="el" href="upgrade_8h.html#a4b1354373fa3ef827b9d6968b17b1443af873b72aabd5cbf304b7d676bf329b92">UPGRADE_LOGICAL_BANKING_SINGLE_ERASE_TO_UPDATE</a>
<br/>
 }</td></tr>
<tr class="memdesc:a4b1354373fa3ef827b9d6968b17b1443"><td class="mdescLeft">&#160;</td><td class="mdescRight">Arrangement of physical flash partitions for a logical flash partition that is managed by this library.  <a href="upgrade_8h.html#a4b1354373fa3ef827b9d6968b17b1443">More...</a><br/></td></tr>
<tr class="separator:a4b1354373fa3ef827b9d6968b17b1443"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aeeb2e43c8a780702137808dad885260e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="upgrade_8h.html#aeeb2e43c8a780702137808dad885260e">UpgradeInit</a> (<a class="el" href="message___8h.html#a51d7b6544fb734b892b35ce3f56a579a">Task</a> appTask, <a class="el" href="csrtypes_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> key, <a class="el" href="csrtypes_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> offset, const <a class="el" href="struct_u_p_g_r_a_d_e___u_p_g_r_a_d_a_b_l_e___p_a_r_t_i_t_i_o_n___t.html">UPGRADE_UPGRADABLE_PARTITION_T</a> *logicalPartitions, <a class="el" href="csrtypes_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> numPartitions, <a class="el" href="upgrade_8h.html#abefdb7759810ea490f6e1f78c7989e5b">upgrade_power_management_t</a> power_state, const char *dev_variant, <a class="el" href="upgrade_8h.html#aaac5b24e409e269fdb8e330611d5d99e">upgrade_permission_t</a> init_perm, const <a class="el" href="structupgrade__version.html">upgrade_version</a> *init_version, <a class="el" href="csrtypes_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> init_config_version)</td></tr>
<tr class="memdesc:aeeb2e43c8a780702137808dad885260e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise the Upgrade library.  <a href="#aeeb2e43c8a780702137808dad885260e">More...</a><br/></td></tr>
<tr class="separator:aeeb2e43c8a780702137808dad885260e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6caf9855fa2ece36a87725a03a268b52"><td class="memItemLeft" align="right" valign="top"><a class="el" href="csrtypes_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="upgrade_8h.html#a6caf9855fa2ece36a87725a03a268b52">UpgradeGetPartitionInUse</a> (<a class="el" href="csrtypes_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> logicalPartition)</td></tr>
<tr class="memdesc:a6caf9855fa2ece36a87725a03a268b52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find out current physical partition for a logical partion.  <a href="#a6caf9855fa2ece36a87725a03a268b52">More...</a><br/></td></tr>
<tr class="separator:a6caf9855fa2ece36a87725a03a268b52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fede515626ae660a7ac6429e7b3d214"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="upgrade_8h.html#a0fede515626ae660a7ac6429e7b3d214">UpgradeHandleMsg</a> (<a class="el" href="message___8h.html#a51d7b6544fb734b892b35ce3f56a579a">Task</a> task, <a class="el" href="message___8h.html#aa135f64d9b1113995d9335c8e9314d95">MessageId</a> id, <a class="el" href="message___8h.html#acc69ef471490ab4c4bfd1e511aba5c74">Message</a> message)</td></tr>
<tr class="memdesc:a0fede515626ae660a7ac6429e7b3d214"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main message handler for the upgrade library.  <a href="#a0fede515626ae660a7ac6429e7b3d214">More...</a><br/></td></tr>
<tr class="separator:a0fede515626ae660a7ac6429e7b3d214"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed19938f426cdd9bc4b6bd21659f4788"><td class="memItemLeft" align="right" valign="top"><a class="el" href="upgrade_8h.html#afb3e52d5bdfde3eb77f620f5b52c2e4a">upgrade_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="upgrade_8h.html#aed19938f426cdd9bc4b6bd21659f4788">UpgradePermit</a> (<a class="el" href="upgrade_8h.html#aaac5b24e409e269fdb8e330611d5d99e">upgrade_permission_t</a> perm)</td></tr>
<tr class="memdesc:aed19938f426cdd9bc4b6bd21659f4788"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specify the type of permission which the upgrade has to perform upgrade operations.  <a href="#aed19938f426cdd9bc4b6bd21659f4788">More...</a><br/></td></tr>
<tr class="separator:aed19938f426cdd9bc4b6bd21659f4788"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28b2bf314b91c0f5c363229c71462e73"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="upgrade_8h.html#a28b2bf314b91c0f5c363229c71462e73">UpgradeTransportConnectRequest</a> (<a class="el" href="message___8h.html#a51d7b6544fb734b892b35ce3f56a579a">Task</a> transportTask)</td></tr>
<tr class="memdesc:a28b2bf314b91c0f5c363229c71462e73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Connect a transport to the Upgrade library.  <a href="#a28b2bf314b91c0f5c363229c71462e73">More...</a><br/></td></tr>
<tr class="separator:a28b2bf314b91c0f5c363229c71462e73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e6e5dcd93dcb19474939f5fb7b32517"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="upgrade_8h.html#a7e6e5dcd93dcb19474939f5fb7b32517">UpgradeProcessDataRequest</a> (<a class="el" href="csrtypes_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> size_data, <a class="el" href="csrtypes_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> *data)</td></tr>
<tr class="memdesc:a7e6e5dcd93dcb19474939f5fb7b32517"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pass a data packet from a client to the Upgrade library.  <a href="#a7e6e5dcd93dcb19474939f5fb7b32517">More...</a><br/></td></tr>
<tr class="separator:a7e6e5dcd93dcb19474939f5fb7b32517"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91f2bcad38ebf0c7a1b4744a6f933ed2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="upgrade_8h.html#a91f2bcad38ebf0c7a1b4744a6f933ed2">UpgradeTransportDisconnectRequest</a> (void)</td></tr>
<tr class="memdesc:a91f2bcad38ebf0c7a1b4744a6f933ed2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disconnect a transport from the Upgrade library.  <a href="#a91f2bcad38ebf0c7a1b4744a6f933ed2">More...</a><br/></td></tr>
<tr class="separator:a91f2bcad38ebf0c7a1b4744a6f933ed2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f444b2f45408df14b98867e1b53153c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="upgrade_8h.html#a3f444b2f45408df14b98867e1b53153c">UpgradeDfuStatus</a> (<a class="el" href="struct_message_d_f_u_from_s_qif_status.html">MessageDFUFromSQifStatus</a> *message)</td></tr>
<tr class="memdesc:a3f444b2f45408df14b98867e1b53153c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inform the Upgrade library of the result an attempt to perform DFU from serial flash.  <a href="#a3f444b2f45408df14b98867e1b53153c">More...</a><br/></td></tr>
<tr class="separator:a3f444b2f45408df14b98867e1b53153c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63ef8f910494039ea79473e5ec160130"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="upgrade_8h.html#a63ef8f910494039ea79473e5ec160130">UpgradeApplyResponse</a> (<a class="el" href="csrtypes_8h.html#a4b435a49c74bb91f284f075e63416cb6">uint32</a> postpone)</td></tr>
<tr class="memdesc:a63ef8f910494039ea79473e5ec160130"><td class="mdescLeft">&#160;</td><td class="mdescRight">Control reboot of device in interactive mode.  <a href="#a63ef8f910494039ea79473e5ec160130">More...</a><br/></td></tr>
<tr class="separator:a63ef8f910494039ea79473e5ec160130"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85954f0cfb18ebe7d8c2953b9f4b461d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="upgrade_8h.html#a85954f0cfb18ebe7d8c2953b9f4b461d">UpgradeBlockingResponse</a> (<a class="el" href="csrtypes_8h.html#a4b435a49c74bb91f284f075e63416cb6">uint32</a> postpone)</td></tr>
<tr class="memdesc:a85954f0cfb18ebe7d8c2953b9f4b461d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Control blocking of the system in interactive mode.  <a href="#a85954f0cfb18ebe7d8c2953b9f4b461d">More...</a><br/></td></tr>
<tr class="separator:a85954f0cfb18ebe7d8c2953b9f4b461d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a502daf85950dce67003154f8b34265c7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="upgrade_8h.html#afb3e52d5bdfde3eb77f620f5b52c2e4a">upgrade_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="upgrade_8h.html#a502daf85950dce67003154f8b34265c7">UpgradePowerManagementSetState</a> (<a class="el" href="upgrade_8h.html#af7acfcc0e02d33de311a7dfe9829cfad">upgrade_power_state_t</a> state)</td></tr>
<tr class="memdesc:a502daf85950dce67003154f8b34265c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receives the current state of the power management from the Sink App.  <a href="#a502daf85950dce67003154f8b34265c7">More...</a><br/></td></tr>
<tr class="separator:a502daf85950dce67003154f8b34265c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header file for the Upgrade library. </p>
<p>Interface to the Upgrade library which provides support for upgrading CSR device software, using the VM Upgrade mechanism.</p>
<p>The library exposes a functional downstream API and an upstream message based API.</p>
<p>See <a class="el" href="otau_library.html">Upgrade library integration</a> </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a8c1d3fc95a1be73bdae951db217b0178"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UPGRADE_HOST_IF_MSG_BASE&#160;&#160;&#160;0x500</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a2d196d818f11fad478fb4684e69fd0aa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UPGRADE_INIT_POWER_MANAGEMENT&#160;&#160;&#160;<a class="el" href="upgrade_8h.html#abefdb7759810ea490f6e1f78c7989e5baac57a380b709ce065434ffafe25b965f">upgrade_power_management_disabled</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ae75379efe615d6123c85607c36aa6897"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UPGRADE_DEFAULT_DEV_VARIANT&#160;&#160;&#160;&quot;ZARKOV77&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad8786c0c6d582457ac5beef66fa71ba3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UPGRADE_PARTITION_SINGLE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">bank, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">banktype&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;{ bank, 0, bank, UPGRADE_LOGICAL_BANKING_SINGLE_##banktype }</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>macro to be used when initialising an <a class="el" href="struct_u_p_g_r_a_d_e___u_p_g_r_a_d_a_b_l_e___p_a_r_t_i_t_i_o_n___t.html" title="Element defining the physical partitions in flash that apply to this logical partition. ">UPGRADE_UPGRADABLE_PARTITION_T</a> entry. </p>
<p>The macro is recommended as the supported bank types may change in future, possibly requiring a layout change in the structure - or more complex initialisation. </p>

</div>
</div>
<a class="anchor" id="a1aba23a64dc86dc6d24176c413d1232f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UPGRADE_PARTITION_DOUBLE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">first_bank, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">second_bank, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">banktype&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;{ first_bank, 0, second_bank, UPGRADE_LOGICAL_BANKING_DOUBLE_##banktype }</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>macro to be used when initialising an <a class="el" href="struct_u_p_g_r_a_d_e___u_p_g_r_a_d_a_b_l_e___p_a_r_t_i_t_i_o_n___t.html" title="Element defining the physical partitions in flash that apply to this logical partition. ">UPGRADE_UPGRADABLE_PARTITION_T</a> entry. </p>
<p>The macro is recommended as the supported bank types may change in future, possibly requiring a layout change in the structure - or more complex initialisation. </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="afb3e52d5bdfde3eb77f620f5b52c2e4a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="upgrade_8h.html#afb3e52d5bdfde3eb77f620f5b52c2e4a">upgrade_status_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enumeration of status types used by Upgrade library API. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="afb3e52d5bdfde3eb77f620f5b52c2e4aa88c518a488af1521263fcb7dfecc3afc"></a>upgrade_status_success</em>&nbsp;</td><td class="fielddoc">
<p>Operation succeeded. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="afb3e52d5bdfde3eb77f620f5b52c2e4aa328e99b64fd88537897f0cb1f1d24b71"></a>upgrade_status_unexpected_error</em>&nbsp;</td><td class="fielddoc">
<p>Operation failed </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="afb3e52d5bdfde3eb77f620f5b52c2e4aa60bb194947b5e0301a0b289a893959d1"></a>upgrade_status_already_connected_warning</em>&nbsp;</td><td class="fielddoc">
<p>already connected </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="afb3e52d5bdfde3eb77f620f5b52c2e4aac8f4f891942eff5b04b75ce305869e74"></a>upgrade_status_in_progress</em>&nbsp;</td><td class="fielddoc">
<p>Requested operation failed, an upgrade is in progress </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="afb3e52d5bdfde3eb77f620f5b52c2e4aa841248efbd106f191459fd2856ce0997"></a>upgrade_status_busy</em>&nbsp;</td><td class="fielddoc">
<p>UNUSED </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="afb3e52d5bdfde3eb77f620f5b52c2e4aa99d684f574261ea10d2a8073560d03ec"></a>upgrade_status_invalid_power_state</em>&nbsp;</td><td class="fielddoc">
<p>Invalid power management state </p>
</td></tr>
</table>

</div>
</div>
<a class="anchor" id="abca8081d155a70bbaec4f4eb8aa43ff8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="upgrade_8h.html#abca8081d155a70bbaec4f4eb8aa43ff8">upgrade_application_message</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enumeration of message IDs used by Upgrade library when sending messages to the application. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="abca8081d155a70bbaec4f4eb8aa43ff8aa0bfad1e4c764c2e9cd81658350f2d05"></a>UPGRADE_INIT_CFM</em>&nbsp;</td><td class="fielddoc">
<p>Message sent in response to <a class="el" href="upgrade_8h.html#aeeb2e43c8a780702137808dad885260e" title="Initialise the Upgrade library. ">UpgradeInit()</a>. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="abca8081d155a70bbaec4f4eb8aa43ff8a126e0820b77ee3a8b1b6fc52ab76faec"></a>UPGRADE_RESTARTED_IND</em>&nbsp;</td><td class="fielddoc">
<p>Message sent during initialisation of the upgrade library to let the VM application know that a restart has occurred and reconnection to a host may be required. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="abca8081d155a70bbaec4f4eb8aa43ff8ab1b469ac6df68b4faf8773a59edfcd6b"></a>UPGRADE_APPLY_IND</em>&nbsp;</td><td class="fielddoc">
<p>Message sent to application to request applying a downloaded upgrade. Note this may include a warm reboot of the device. Application must respond with <a class="el" href="upgrade_8h.html#a63ef8f910494039ea79473e5ec160130" title="Control reboot of device in interactive mode. ">UpgradeApplyResponse()</a> </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="abca8081d155a70bbaec4f4eb8aa43ff8a2dc467a743fbdecc9ced48241f481fb4"></a>UPGRADE_BLOCKING_IND</em>&nbsp;</td><td class="fielddoc">
<p>Message sent to application to request blocking the system for an extended period of time to erase serial flash partitions. Application must respond with <a class="el" href="upgrade_8h.html#a85954f0cfb18ebe7d8c2953b9f4b461d" title="Control blocking of the system in interactive mode. ">UpgradeBlockingResponse()</a> </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="abca8081d155a70bbaec4f4eb8aa43ff8ae6ebacda93ea7d7c3408d20517f67332"></a>UPGRADE_BLOCKING_IS_DONE_IND</em>&nbsp;</td><td class="fielddoc">
<p>Message sent to application to indicate that blocking operation is finished </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="abca8081d155a70bbaec4f4eb8aa43ff8a63845b901d54abe03cf35c58bb1e4c18"></a>UPGRADE_STATUS_IND</em>&nbsp;</td><td class="fielddoc">
<p>Message sent to application to inform of the current status of an upgrade. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="abca8081d155a70bbaec4f4eb8aa43ff8a791d75abb7b2ead5a5aa5337c241b76d"></a>UPGRADE_UPSTREAM_MESSAGE_TOP</em>&nbsp;</td><td class="fielddoc">
<p>ID for first message outside of this range </p>
</td></tr>
</table>

</div>
</div>
<a class="anchor" id="a0a221dfdae3f8abae8645ae636e94044"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="upgrade_8h.html#a0a221dfdae3f8abae8645ae636e94044">upgrade_transport_message</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enumeration of message IDs used by the Upgrade library when sending messages to the transport task. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="a0a221dfdae3f8abae8645ae636e94044a3bb91e6cfeca8dcce82cb2a78dd83d12"></a>UPGRADE_TRANSPORT_CONNECT_CFM</em>&nbsp;</td><td class="fielddoc">
<p>Message sent in reponse to <a class="el" href="upgrade_8h.html#a28b2bf314b91c0f5c363229c71462e73" title="Connect a transport to the Upgrade library. ">UpgradeTransportConnectRequest()</a>. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a0a221dfdae3f8abae8645ae636e94044ac72f01268204b9246d4f0b39f662467d"></a>UPGRADE_TRANSPORT_DISCONNECT_CFM</em>&nbsp;</td><td class="fielddoc">
<p>Message sent in response to <a class="el" href="upgrade_8h.html#a91f2bcad38ebf0c7a1b4744a6f933ed2" title="Disconnect a transport from the Upgrade library. ">UpgradeTransportDisconnectRequest()</a>. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a0a221dfdae3f8abae8645ae636e94044a381862e04eb48776b0b8a9fb48032370"></a>UPGRADE_TRANSPORT_DATA_IND</em>&nbsp;</td><td class="fielddoc">
<p>Message sent to a transport to send a data packet to a client. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a0a221dfdae3f8abae8645ae636e94044a7109e55b3f87fb65252db77672180fa1"></a>UPGRADE_TRANSPORT_DATA_CFM</em>&nbsp;</td><td class="fielddoc">
<p>Message sent in response to <a class="el" href="upgrade_8h.html#a7e6e5dcd93dcb19474939f5fb7b32517" title="Pass a data packet from a client to the Upgrade library. ">UpgradeProcessDataRequest()</a>. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a0a221dfdae3f8abae8645ae636e94044a5c2b280183bd6aff7b2e15d50000fc47"></a>UPGRADE_DOWNSTREAM_MESSAGE_TOP</em>&nbsp;</td><td class="fielddoc">
<p>ID for first message outside of this range </p>
</td></tr>
</table>

</div>
</div>
<a class="anchor" id="aaac5b24e409e269fdb8e330611d5d99e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="upgrade_8h.html#aaac5b24e409e269fdb8e330611d5d99e">upgrade_permission_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Types of permission that are given to the upgrade library. </p>
<p>A VM application must give permission for the VM upgrade library to both perform upgrade operations in general, and also for specific operations which have the potential to effect system behaviour, such as reboots or pauses due to serial flash erasing. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="aaac5b24e409e269fdb8e330611d5d99ea2057a0e19be6b50e1b446d8bba1b8f45"></a>upgrade_perm_no</em>&nbsp;</td><td class="fielddoc">
<p>The upgrade library is not permitted to perform upgrade. Note that the upgrade library may reject this if an upgrade is already in progress. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="aaac5b24e409e269fdb8e330611d5d99ea7d44485cbad805ea73f1b820ba692086"></a>upgrade_perm_assume_yes</em>&nbsp;</td><td class="fielddoc">
<p>Configures the upgrade library to run in an autonomous mode. The library will assume the answer to any decisions point is yes and will automatically act as such, for instance reboots and flash erase operations. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="aaac5b24e409e269fdb8e330611d5d99eae1f05ab99767ab7cff6e98fc9a0a4859"></a>upgrade_perm_always_ask</em>&nbsp;</td><td class="fielddoc">
<p>Configures the upgrade library to always ask the VM application when decision points are reached. This option requires the VM application to handle additional messages from the upgrade library and responding appropriately or upgrade may not complete successfully. </p>
</td></tr>
</table>

</div>
</div>
<a class="anchor" id="a3ca74f71fd564593dd716ae4b7b567f5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="upgrade_8h.html#a3ca74f71fd564593dd716ae4b7b567f5">upgrade_state_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>States which the upgrade library may be in. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="a3ca74f71fd564593dd716ae4b7b567f5abac05453a6990c61bc91273698975aac"></a>upgrade_state_idle</em>&nbsp;</td><td class="fielddoc">
<p>The upgrade library is not currently downloading or commiting an upgrade. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a3ca74f71fd564593dd716ae4b7b567f5af41033515c0ffa60979cf7d116082b55"></a>upgrade_state_downloading</em>&nbsp;</td><td class="fielddoc">
<p>The upgrade library is in the process of downloading an upgrade. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a3ca74f71fd564593dd716ae4b7b567f5a5a6ad4645cf151b83cc0f4251d3ee5f3"></a>upgrade_state_commiting</em>&nbsp;</td><td class="fielddoc">
<p>The upgrade library is in the process of commiting an upgrade. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a3ca74f71fd564593dd716ae4b7b567f5a734bc9be75d7b4d5cd15c7b2f2d83219"></a>upgrade_state_done</em>&nbsp;</td><td class="fielddoc">
<p>The upgrade library has completed an upgrade. </p>
</td></tr>
</table>

</div>
</div>
<a class="anchor" id="abefdb7759810ea490f6e1f78c7989e5b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="upgrade_8h.html#abefdb7759810ea490f6e1f78c7989e5b">upgrade_power_management_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enumeration power management initialization. </p>
<p>There are the possible states of power management. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="abefdb7759810ea490f6e1f78c7989e5baac57a380b709ce065434ffafe25b965f"></a>upgrade_power_management_disabled</em>&nbsp;</td><td class="fielddoc">
<p>There is no power management in place (e.g. device is not battery powered) </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="abefdb7759810ea490f6e1f78c7989e5baf0725de6183ef7ac4399b27acd8cc7c3"></a>upgrade_battery_powered</em>&nbsp;</td><td class="fielddoc">
<p>This is the initialized mode when battery powered </p>
</td></tr>
</table>

</div>
</div>
<a class="anchor" id="af7acfcc0e02d33de311a7dfe9829cfad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="upgrade_8h.html#af7acfcc0e02d33de311a7dfe9829cfad">upgrade_power_state_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enumeration power management state. </p>
<p>There are the possible states of power management. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="af7acfcc0e02d33de311a7dfe9829cfada525af91cdf6390a26ddff8f88f6ee7b8"></a>upgrade_battery_ok</em>&nbsp;</td><td class="fielddoc">
<p>Battery is above the low level threshold and upgrade is allowed. This state is set also when charger is removed and battery is ok </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="af7acfcc0e02d33de311a7dfe9829cfada2fea563568b2ac8117be83df152f1eed"></a>upgrade_battery_low</em>&nbsp;</td><td class="fielddoc">
<p>Battery is below the low level threshold and upgrade is no longer allowed. This state is set also when charger is removed and battery still hasn't got enough charge </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="af7acfcc0e02d33de311a7dfe9829cfada42950af9f5a0fb4233f17ee02827d2fb"></a>upgrade_charger_connected</em>&nbsp;</td><td class="fielddoc">
<p>Indicate that battery is charging </p>
</td></tr>
</table>

</div>
</div>
<a class="anchor" id="a08466801879b35c7ddae4bddb3e3e9e0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="upgrade_8h.html#a08466801879b35c7ddae4bddb3e3e9e0">upgrade_reconnect_recommendation_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reasons for reconnection. </p>
<p>Gives the reason why the library is asking the application to trigger a host reconnection. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="a08466801879b35c7ddae4bddb3e3e9e0adc1095218f0111408b301812baa7039f"></a>upgrade_reconnect_not_required</em>&nbsp;</td><td class="fielddoc">
<p>reconnection not needed, no upgrade is in progress. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a08466801879b35c7ddae4bddb3e3e9e0a908cd91bf55d2821919ed82f116b40bf"></a>upgrade_reconnect_required_for_confirm</em>&nbsp;</td><td class="fielddoc">
<p>High priority request for reconnection.</p>
<p>The upgrade is not yet confirmed and host action is required to accept or reject the upgrade </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a08466801879b35c7ddae4bddb3e3e9e0a6ae9da9ac32254101ade6af43f8415ff"></a>upgrade_reconnect_recommended_as_completed</em>&nbsp;</td><td class="fielddoc">
<p>Low priority request for reconnection.</p>
<p>An upgrade has completed and reconnecting to the host will allow the host to report the success.</p>
<p>The upgrade cannot now be rolled back so reconnection is not mandatory. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a08466801879b35c7ddae4bddb3e3e9e0a1443ebff8e33b953c796cfce3d51486b"></a>upgrade_reconnect_recommended_in_progress</em>&nbsp;</td><td class="fielddoc">
<p>Optional request for reconnection.</p>
<p>An upgrade was in progress, but had not reached a critical state. The application is best placed to decide if reconnecting to a host is a priority.</p>
<p>For example, a sound bar - with an external power source, might choose to enable connections; a headset on battery power might not - it was probably reset for a reason </p>
</td></tr>
</table>

</div>
</div>
<a class="anchor" id="a4b1354373fa3ef827b9d6968b17b1443"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="upgrade_8h.html#a4b1354373fa3ef827b9d6968b17b1443">UPGRADE_LOGICAL_PARTITION_ARRANGEMENT</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Arrangement of physical flash partitions for a logical flash partition that is managed by this library. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="a4b1354373fa3ef827b9d6968b17b1443abb8cf6d57e3ce55b6fa529d95be7c673"></a>UPGRADE_LOGICAL_BANKING_SINGLE_KEEP_ERASED</em>&nbsp;</td><td class="fielddoc">
<p>Indicates a partition, that is not part of a pair, and that will always be erased after an upgrade completes. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a4b1354373fa3ef827b9d6968b17b1443a7e6abf6fef2b5d84efc0f8c18daf6ef1"></a>UPGRADE_LOGICAL_BANKING_SINGLE_DFU</em>&nbsp;</td><td class="fielddoc">
<p>Partition used for DFU (synonym for <a class="el" href="upgrade_8h.html#a4b1354373fa3ef827b9d6968b17b1443abb8cf6d57e3ce55b6fa529d95be7c673">UPGRADE_LOGICAL_BANKING_SINGLE_KEEP_ERASED</a>) </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a4b1354373fa3ef827b9d6968b17b1443a2ff3bb74dd654f5861c98b0380ba6ecc"></a>UPGRADE_LOGICAL_BANKING_DOUBLE_UNMOUNTED</em>&nbsp;</td><td class="fielddoc">
<p>A partition pair that is not used for a file system. These partitions will be of type raw serial </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a4b1354373fa3ef827b9d6968b17b1443a3148d7cac57e30af1fd9598cf3a7c2d1"></a>UPGRADE_LOGICAL_BANKING_DOUBLE_MOUNTED</em>&nbsp;</td><td class="fielddoc">
<p>A partition pair that is used in a file system. These partitions will be of type read only (although they can be upgraded). Following an upgrade of these partitions the file system table will be updated so that the newly updated partition is active. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a4b1354373fa3ef827b9d6968b17b1443af873b72aabd5cbf304b7d676bf329b92"></a>UPGRADE_LOGICAL_BANKING_SINGLE_ERASE_TO_UPDATE</em>&nbsp;</td><td class="fielddoc">
<p>A partition, that is not part of a pair, and is not kept erased by the upgrade library.</p>
<dl class="section note"><dt>Note</dt><dd>This type of partition is not supported at present. </dd></dl>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aeeb2e43c8a780702137808dad885260e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UpgradeInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="message___8h.html#a51d7b6544fb734b892b35ce3f56a579a">Task</a>&#160;</td>
          <td class="paramname"><em>appTask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="csrtypes_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a>&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="csrtypes_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a>&#160;</td>
          <td class="paramname"><em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_u_p_g_r_a_d_e___u_p_g_r_a_d_a_b_l_e___p_a_r_t_i_t_i_o_n___t.html">UPGRADE_UPGRADABLE_PARTITION_T</a> *&#160;</td>
          <td class="paramname"><em>logicalPartitions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="csrtypes_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a>&#160;</td>
          <td class="paramname"><em>numPartitions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="upgrade_8h.html#abefdb7759810ea490f6e1f78c7989e5b">upgrade_power_management_t</a>&#160;</td>
          <td class="paramname"><em>power_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>dev_variant</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="upgrade_8h.html#aaac5b24e409e269fdb8e330611d5d99e">upgrade_permission_t</a>&#160;</td>
          <td class="paramname"><em>init_perm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structupgrade__version.html">upgrade_version</a> *&#160;</td>
          <td class="paramname"><em>init_version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="csrtypes_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a>&#160;</td>
          <td class="paramname"><em>init_config_version</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise the Upgrade library. </p>
<p>Must be called before any other Upgrade library API is used. Upgrade library will respond with <a class="el" href="struct_u_p_g_r_a_d_e___i_n_i_t___c_f_m___t.html" title="Definition of the message sent in response to UpgradeInit(). ">UPGRADE_INIT_CFM_T</a> message, the library is only considered initialised if the status field of the <a class="el" href="struct_u_p_g_r_a_d_e___i_n_i_t___c_f_m___t.html" title="Definition of the message sent in response to UpgradeInit(). ">UPGRADE_INIT_CFM_T</a> message is <a class="el" href="upgrade_8h.html#afb3e52d5bdfde3eb77f620f5b52c2e4aa88c518a488af1521263fcb7dfecc3afc">upgrade_status_success</a>.</p>
<p>The initialisation informs the upgrade library of the partitions that may be upgraded. Only partitions referenced here can be upgraded.</p>
<p>If your application uses upgradable raw serial (RS) partitions then you should not make any assumptions about the active partition, instead call the function <a class="el" href="upgrade_8h.html#a6caf9855fa2ece36a87725a03a268b52">UpgradeGetPartitionInUse</a> to retrieve the currently active partition ID.</p>
<p>The upgrade library must be initialised with an "enabled" permission of either <a class="el" href="upgrade_8h.html#aaac5b24e409e269fdb8e330611d5d99ea7d44485cbad805ea73f1b820ba692086">upgrade_perm_assume_yes</a> or <a class="el" href="upgrade_8h.html#aaac5b24e409e269fdb8e330611d5d99eae1f05ab99767ab7cff6e98fc9a0a4859">upgrade_perm_always_ask</a>. If the application wishes to disable upgrades it must call <a class="el" href="upgrade_8h.html#aed19938f426cdd9bc4b6bd21659f4788" title="Specify the type of permission which the upgrade has to perform upgrade operations. ">UpgradePermit()</a> with the <a class="el" href="upgrade_8h.html#aaac5b24e409e269fdb8e330611d5d99ea2057a0e19be6b50e1b446d8bba1b8f45">upgrade_perm_no</a> parameter, after successful initalisation. Note that this may be rejected if an upgrade is already in progress. The upgrade library will send an <a class="el" href="upgrade_8h.html#abca8081d155a70bbaec4f4eb8aa43ff8a63845b901d54abe03cf35c58bb1e4c18">UPGRADE_STATUS_IND</a> message when an in progress upgrade has been completed, after which upgrades may be disabled.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">appTask</td><td>The application task to receive Upgrade library messages. </td></tr>
    <tr><td class="paramname">key</td><td>PSKey the Upgrade library may use to store data. </td></tr>
    <tr><td class="paramname">offset</td><td>The word offset within the PSKey from which the upgrade may store data. </td></tr>
    <tr><td class="paramname">logicalPartitions</td><td>Pointer to an array defining the partitions that are managed by the upgrade library. The first entry defines logical partition 0 etc. </td></tr>
    <tr><td class="paramname">numPartitions</td><td>Number of logical partitions in the logicalPartitions array </td></tr>
    <tr><td class="paramname">power_state</td><td>Current power management state </td></tr>
    <tr><td class="paramname">dev_variant</td><td>Name of this device variant. Checked against the variant in the upgrade file header. If NULL, check is ignored. </td></tr>
    <tr><td class="paramname">init_perm</td><td>Initial state of upgrade library permissions. </td></tr>
    <tr><td class="paramname">init_version</td><td>Factory-default upgrade version of this app. Once an upgrade has been done, the upgrade version from the upgrade file header will be used. </td></tr>
    <tr><td class="paramname">init_config_version</td><td>Factory-default PS data config version of this app. Once an upgrade has been done, the PS config version from the upgrade file header will be used. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a6caf9855fa2ece36a87725a03a268b52"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="csrtypes_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> UpgradeGetPartitionInUse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="csrtypes_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a>&#160;</td>
          <td class="paramname"><em>logicalPartition</em>)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find out current physical partition for a logical partion. </p>
<p>This function uses the array of logical partitions supplied during AppInit, as well as the librarys knowledge of the state of partitions to return a reference to the physical partition that is active.</p>
<p>This is most useful for raw serial (RS) partitions as these need to be accessed directly by the application. Read only (RO) partitions are typically mounted as file systems and the appropriate partition will already be active.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">logicalPartition</td><td>Index into the table of <a class="el" href="struct_u_p_g_r_a_d_e___u_p_g_r_a_d_a_b_l_e___p_a_r_t_i_t_i_o_n___t.html" title="Element defining the physical partitions in flash that apply to this logical partition. ">UPGRADE_UPGRADABLE_PARTITION_T</a> supplied during <a class="el" href="upgrade_8h.html#aeeb2e43c8a780702137808dad885260e">UpgradeInit</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Definition of physical partition, 0 in case of error. The partition information matches the format used in PSKEY_FSTAB </dd></dl>

</div>
</div>
<a class="anchor" id="a0fede515626ae660a7ac6429e7b3d214"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UpgradeHandleMsg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="message___8h.html#a51d7b6544fb734b892b35ce3f56a579a">Task</a>&#160;</td>
          <td class="paramname"><em>task</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="message___8h.html#aa135f64d9b1113995d9335c8e9314d95">MessageId</a>&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="message___8h.html#acc69ef471490ab4c4bfd1e511aba5c74">Message</a>&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main message handler for the upgrade library. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">task</td><td>Task of the message sender. </td></tr>
    <tr><td class="paramname">id</td><td>Message identifier. </td></tr>
    <tr><td class="paramname">message</td><td>Message contents. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aed19938f426cdd9bc4b6bd21659f4788"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="upgrade_8h.html#afb3e52d5bdfde3eb77f620f5b52c2e4a">upgrade_status_t</a> UpgradePermit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="upgrade_8h.html#aaac5b24e409e269fdb8e330611d5d99e">upgrade_permission_t</a>&#160;</td>
          <td class="paramname"><em>perm</em>)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Specify the type of permission which the upgrade has to perform upgrade operations. </p>
<p>The default permission is provided by the VM application in <a class="el" href="upgrade_8h.html#aeeb2e43c8a780702137808dad885260e" title="Initialise the Upgrade library. ">UpgradeInit()</a>, this must be either <a class="el" href="upgrade_8h.html#aaac5b24e409e269fdb8e330611d5d99ea7d44485cbad805ea73f1b820ba692086">upgrade_perm_assume_yes</a> or <a class="el" href="upgrade_8h.html#aaac5b24e409e269fdb8e330611d5d99eae1f05ab99767ab7cff6e98fc9a0a4859">upgrade_perm_always_ask</a>. The VM application may subsequently use this function to modify the type of permission as required.</p>
<p>The upgrade library may reject an attempt by the VM application to disable upgrades, if an upgrade is already in progress and the platforms does not support the resume feature. If rejected due to an upgrade already in progress, the upgrade library will send a <a class="el" href="upgrade_8h.html#abca8081d155a70bbaec4f4eb8aa43ff8a63845b901d54abe03cf35c58bb1e4c18">UPGRADE_STATUS_IND</a> message to the VM application with a state of upgrade_state_done.</p>
<p>There are two types of enabled permission, "assume yes" and "always ask".</p>
<p>The upgrade library can be enabled in an autonomous mode, using the <a class="el" href="upgrade_8h.html#aaac5b24e409e269fdb8e330611d5d99ea7d44485cbad805ea73f1b820ba692086">upgrade_perm_assume_yes</a> permission type. During operation, the upgrade library will assume the answer at key decision points is yes and continue automatically.</p>
<p>Key decision points are :- Rebooting the device as part of completing an upgrade Blocking the system to erase serial flash partition, may effect audio.</p>
<p>The VM application can participate in these decisions by configuring the upgrade library with <a class="el" href="upgrade_8h.html#aaac5b24e409e269fdb8e330611d5d99eae1f05ab99767ab7cff6e98fc9a0a4859">upgrade_perm_always_ask</a> permission type. In this mode, the upgrade library will send <a class="el" href="upgrade_8h.html#abca8081d155a70bbaec4f4eb8aa43ff8ab1b469ac6df68b4faf8773a59edfcd6b">UPGRADE_APPLY_IND</a> and <a class="el" href="upgrade_8h.html#abca8081d155a70bbaec4f4eb8aa43ff8a2dc467a743fbdecc9ced48241f481fb4">UPGRADE_BLOCKING_IND</a> messages to the VM application. The VM application must reply with <a class="el" href="upgrade_8h.html#a63ef8f910494039ea79473e5ec160130" title="Control reboot of device in interactive mode. ">UpgradeApplyResponse()</a> or <a class="el" href="upgrade_8h.html#a85954f0cfb18ebe7d8c2953b9f4b461d" title="Control blocking of the system in interactive mode. ">UpgradeBlockingResponse()</a> respectively or the upgrade process will not succeed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">perm</td><td><a class="el" href="upgrade_8h.html#aaac5b24e409e269fdb8e330611d5d99ea2057a0e19be6b50e1b446d8bba1b8f45">upgrade_perm_no</a> Disable upgades. <a class="el" href="upgrade_8h.html#aaac5b24e409e269fdb8e330611d5d99ea7d44485cbad805ea73f1b820ba692086">upgrade_perm_assume_yes</a> Enable upgrades, automatic mode. <a class="el" href="upgrade_8h.html#aaac5b24e409e269fdb8e330611d5d99eae1f05ab99767ab7cff6e98fc9a0a4859">upgrade_perm_always_ask</a> Enable upgrades, interactive mode.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>upgrade_status_t <a class="el" href="upgrade_8h.html#afb3e52d5bdfde3eb77f620f5b52c2e4aa88c518a488af1521263fcb7dfecc3afc">upgrade_status_success</a> Requested permission change was accepted. <a class="el" href="upgrade_8h.html#afb3e52d5bdfde3eb77f620f5b52c2e4aac8f4f891942eff5b04b75ce305869e74">upgrade_status_in_progress</a> Requested permission denied. </dd></dl>

</div>
</div>
<a class="anchor" id="a28b2bf314b91c0f5c363229c71462e73"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UpgradeTransportConnectRequest </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="message___8h.html#a51d7b6544fb734b892b35ce3f56a579a">Task</a>&#160;</td>
          <td class="paramname"><em>transportTask</em>)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Connect a transport to the Upgrade library. </p>
<p>When a client wants to initiate an upgrade, the transport must first connect to the upgrade library so that it knows which Task to use to send messages to a client.</p>
<p>The Upgrade library will respond by sending UPGRADE_TRANSPORT_CONNECT_CFM to transportTask.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">transportTask</td><td>The Task used by the transport. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a7e6e5dcd93dcb19474939f5fb7b32517"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UpgradeProcessDataRequest </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="csrtypes_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a>&#160;</td>
          <td class="paramname"><em>size_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="csrtypes_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pass a data packet from a client to the Upgrade library. </p>
<p>All data packets from a client should be sent to the Upgrade library via this function. Data packets must be in order but do not need to contain a whole upgrade message.</p>
<p>The Upgrade library will respond by sending UPGRADE_TRANSPORT_DATA_CFM to the Task set in <a class="el" href="upgrade_8h.html#a28b2bf314b91c0f5c363229c71462e73" title="Connect a transport to the Upgrade library. ">UpgradeTransportConnectRequest()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size_data</td><td>Size of the data packet </td></tr>
    <tr><td class="paramname">data</td><td>Pointer to the data packet </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a91f2bcad38ebf0c7a1b4744a6f933ed2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UpgradeTransportDisconnectRequest </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Disconnect a transport from the Upgrade library. </p>
<p>When a transport no longer needs to use the Upgrade library it must disconnect.</p>
<p>The Upgrade library will respond by sending UPGRADE_TRANSPORT_DISCONNECT_CFM to the Task set in <a class="el" href="upgrade_8h.html#a28b2bf314b91c0f5c363229c71462e73" title="Connect a transport to the Upgrade library. ">UpgradeTransportConnectRequest()</a>. </p>

</div>
</div>
<a class="anchor" id="a3f444b2f45408df14b98867e1b53153c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UpgradeDfuStatus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_message_d_f_u_from_s_qif_status.html">MessageDFUFromSQifStatus</a> *&#160;</td>
          <td class="paramname"><em>message</em>)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inform the Upgrade library of the result an attempt to perform DFU from serial flash. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">message</td><td><a class="el" href="system__message_8h.html#af540da5fd8efbb643a9e07b0588175de">MESSAGE_DFU_SQIF_STATUS</a> message containing status of DFU operation. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a63ef8f910494039ea79473e5ec160130"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UpgradeApplyResponse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="csrtypes_8h.html#a4b435a49c74bb91f284f075e63416cb6">uint32</a>&#160;</td>
          <td class="paramname"><em>postpone</em>)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Control reboot of device in interactive mode. </p>
<p>The upgrade library needs to reboot the device to complete an upgrade. If the VM application configured the library with <a class="el" href="upgrade_8h.html#aaac5b24e409e269fdb8e330611d5d99eae1f05ab99767ab7cff6e98fc9a0a4859">upgrade_perm_always_ask</a>, the application will receive <a class="el" href="upgrade_8h.html#abca8081d155a70bbaec4f4eb8aa43ff8ab1b469ac6df68b4faf8773a59edfcd6b">UPGRADE_APPLY_IND</a> messages when the upgrade library needs to reboot.</p>
<p>If the application configured the library with <a class="el" href="upgrade_8h.html#aaac5b24e409e269fdb8e330611d5d99ea7d44485cbad805ea73f1b820ba692086">upgrade_perm_assume_yes</a>, the application will not receive <a class="el" href="upgrade_8h.html#abca8081d155a70bbaec4f4eb8aa43ff8ab1b469ac6df68b4faf8773a59edfcd6b">UPGRADE_APPLY_IND</a> messages and the upgrade library will automatically reboot when required.</p>
<p>The application must use this API to tell the upgrade library when it can reboot. If the application wants to reboot immediately, it should pass a postpone parameter of 0.</p>
<p>If the application wants to postpone the action it can specify a delay in milliseconds to postpone. The upgrade library will resend the <a class="el" href="upgrade_8h.html#abca8081d155a70bbaec4f4eb8aa43ff8ab1b469ac6df68b4faf8773a59edfcd6b">UPGRADE_APPLY_IND</a> message after that delay has elapsed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">postpone</td><td>Time in milliseconds to postpone. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a85954f0cfb18ebe7d8c2953b9f4b461d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UpgradeBlockingResponse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="csrtypes_8h.html#a4b435a49c74bb91f284f075e63416cb6">uint32</a>&#160;</td>
          <td class="paramname"><em>postpone</em>)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Control blocking of the system in interactive mode. </p>
<p>The upgrade library needs to erase serial flash partitions to complete an upgrade, and possibly at other times to clean up an incomplete upgrade.</p>
<p>Serial flash erase operations are blocking, they block the entire system for the duration of the erase, the period of the block is dependent upon the size of the serial flash partition being erased and the characteristics of the flash part used. Erase operations can disrupt streaming audio.</p>
<p>If the VM application configured the library with <a class="el" href="upgrade_8h.html#aaac5b24e409e269fdb8e330611d5d99eae1f05ab99767ab7cff6e98fc9a0a4859">upgrade_perm_always_ask</a>, the application will receive <a class="el" href="upgrade_8h.html#abca8081d155a70bbaec4f4eb8aa43ff8a2dc467a743fbdecc9ced48241f481fb4">UPGRADE_BLOCKING_IND</a> messages when the upgrade library needs to block the system for partition erase.</p>
<p>If the application configured the library with <a class="el" href="upgrade_8h.html#aaac5b24e409e269fdb8e330611d5d99ea7d44485cbad805ea73f1b820ba692086">upgrade_perm_assume_yes</a>, the application will not receive <a class="el" href="upgrade_8h.html#abca8081d155a70bbaec4f4eb8aa43ff8a2dc467a743fbdecc9ced48241f481fb4">UPGRADE_BLOCKING_IND</a> messages and the upgrade library will automatically erase flash partitions when required.</p>
<p>The application must use this API to tell the upgrade library when it can block the system. If the application wants to block immediately, it should pass a postpone parameter of 0.</p>
<p>If the application wants to postpone the action it can specify a delay in milliseconds to postpone. The upgrade library will resend the <a class="el" href="upgrade_8h.html#abca8081d155a70bbaec4f4eb8aa43ff8ab1b469ac6df68b4faf8773a59edfcd6b">UPGRADE_APPLY_IND</a> message after that delay has elapsed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">postpone</td><td>Time in milliseconds to postpone. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a502daf85950dce67003154f8b34265c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="upgrade_8h.html#afb3e52d5bdfde3eb77f620f5b52c2e4a">upgrade_status_t</a> UpgradePowerManagementSetState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="upgrade_8h.html#af7acfcc0e02d33de311a7dfe9829cfad">upgrade_power_state_t</a>&#160;</td>
          <td class="paramname"><em>state</em>)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receives the current state of the power management from the Sink App. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Current power management state </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Sep 2 2019 10:47:44 for BlueLab by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.4
</small></address>
</body>
</html>
